(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{"2a37ac":function(t,e,r){},"49a111":function(t,e,r){"use strict";var n=r("d108c6");r.n(n).a},"5753c7":function(t,e,r){"use strict";var n=r("ffee13");r.n(n).a},"5eb472":function(t,e,r){"use strict";var n=r("a20bd2");r.n(n).a},"757fb8":function(t,e,r){},"8fe135":function(t,e,r){"use strict";r.d(e,"c",(function(){return n})),r.d(e,"b",(function(){return o})),r.d(e,"a",(function(){return c}));var n="reviews/OPEN_DELIVERY_REVIEW_POPUP",o="reviews/DELIVERY_REVIEW_SUCCESS_CREATED",c="drsi"},a17eb6:function(t,e,r){"use strict";r("340dbd"),r("0a5193");var n={name:"CsmaSlider",props:{sliderOptions:{type:Object,default:function(){return{}}}},computed:{itemWidth:function(){if(this.calculateSliderWidth){var t=this.sliderOptions,e=t.spaceBetween,r=t.slidesPerView;return 1===r?this.$refs.container.clientWidth-4*e:this.$refs.container.clientWidth/r-(r-1)*e}},calculateSliderWidth:function(){return!!this.sliderOptions.spaceBetween&&!!this.sliderOptions.slidesPerView}},mounted:function(){var t=this,e=this.$refs.wrapper;this.calculateSliderWidth&&Array.from(e.children).filter((function(t){return!t.classList.contains("last-item")})).forEach((function(e){e.style.width=t.itemWidth+"px",e.style.marginRight=t.spaceBetween+"px"}))}},o=(r("c4dc0f"),r("b429cb")),component=Object(o.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"container",staticClass:"slider-container"},[e("div",{ref:"wrapper",staticClass:"slider-wrapper"},[this._t("mainItems"),this._v(" "),this._t("lastItem")],2)])}),[],!1,null,"577b6c88",null);e.a=component.exports},a20bd2:function(t,e,r){},a51d8c:function(t,e,r){"use strict";var n=r("2a37ac");r.n(n).a},b1cacd:function(t,e,r){"use strict";r.r(e);var n=r("487109"),o=r("21919a"),c=r("6876d5"),h=function(){return(h=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},l={name:"OrdersWithoutShipments",components:{CDNImageRetinaWrapper:o.a},props:{orderWithoutShipments:{type:Object,default:function(){return{}}}},computed:h({},Object(c.e)({userShowAdult:function(t){return t.userInfo.showAdult}}),{showAdultPlaceholder:function(){return!this.userShowAdult&&this.orderWithoutShipments.isAdult},getCountTitle:function(){var t=this.orderWithoutShipments.productsCount;return t>1&&t<5?"товара":"товаров"}}),methods:h({},Object(c.b)({setShowAdultModal:"userInfo/SET_SHOW_ADULT_MODAL"}),{onImageClick:function(t){this.showAdultPlaceholder&&(t.preventDefault(),t.stopPropagation(),this.setShowAdultModal(!0),this.$when.once("userInfo/SET_SHOW_ADULT",(function(){t.target.click()})))}})},d=(r("49a111"),r("b429cb")),m=Object(d.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tracker-container"},[r("div",{staticClass:"image-block",on:{click:t.onImageClick}},[r("CDNImageRetinaWrapper",{staticClass:"image",class:{"is-adult":t.orderWithoutShipments.isAdult&&!t.userShowAdult},attrs:{"is-adult":t.orderWithoutShipments.isAdult&&!t.userShowAdult,size:112,src:t.orderWithoutShipments.image}}),t._v(" "),t.orderWithoutShipments.productsCount>1?r("span",{staticClass:"qty"},[t._v(t._s(t.orderWithoutShipments.productsCount)),r("br"),t._v(t._s(t.getCountTitle))]):t._e()],1),t._v(" "),r("div",{staticClass:"information"},[t.orderWithoutShipments.status?r("span",{staticClass:"status",style:{backgroundColor:t.orderWithoutShipments.status.color}},[t._v("\n      "+t._s(t.orderWithoutShipments.status.name.toUpperCase())+"\n    ")]):t._e(),t._v(" "),r("span",{staticClass:"hint"},[t._v(t._s(t.orderWithoutShipments.hint))])])])}),[],!1,null,"dd89e6c6",null).exports,f=(r("f8695b"),r("41d819"),r("aae158"),r("b902cb")),v=r("8fe135"),_=r("cf1cd4"),S=function(){return(S=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},w=function(t,e,r,n){return new(r||(r=Promise))((function(o,c){function h(t){try{d(n.next(t))}catch(t){c(t)}}function l(t){try{d(n.throw(t))}catch(t){c(t)}}function d(t){t.done?o(t.value):new r((function(e){e(t.value)})).then(h,l)}d((n=n.apply(t,e||[])).next())}))},C=function(t,body){var e,r,n,g,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(h){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,r&&(n=2&c[0]?r.return:c[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,c[1])).done)return n;switch(r=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){o.label=c[1];break}if(6===c[0]&&o.label<n[1]){o.label=n[1],n=c;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(c);break}n[2]&&o.ops.pop(),o.trys.pop();continue}c=body.call(t,o)}catch(t){c=[6,t],r=0}finally{e=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,h])}}},O={name:"OrdersWithShipments",components:{CDNImageRetinaWrapper:o.a,OzonButton:f.b},props:{shipment:{type:Object,default:function(){return{}}},useBarcode:{type:Boolean,default:!1}},data:function(){return{showReview:this.shipment.deliveryReviewInfo&&this.shipment.deliveryReviewInfo.hasReview}},computed:S({},Object(c.e)({userShowAdult:function(t){return t.userInfo.showAdult}}),{showAdultPlaceholder:function(){return!this.userShowAdult&&this.shipment.isAdult},getCountTitle:function(){var t=this.shipment.productsCount;return t>1&&t<5?"товара":"товаров"}}),methods:S({},Object(c.b)({setShowAdultModal:"userInfo/SET_SHOW_ADULT_MODAL"}),{onDeliveryReview:function(){return w(this,void 0,Promise,(function(){var t,e,r,n,o,c=this;return C(this,(function(h){switch(h.label){case 0:return t=this.shipment.deliveryReviewInfo,e=t.shipmentId,r=t.price,n=t.date,o={readOnly:this.showReview,info:{shipmentId:e,price:r,date:n}},[4,this.$store.dispatch(v.c,o).then((function(t){c.showReview=t}))];case 1:return h.sent(),[2]}}))}))},onBarcodeClick:function(){var t=this.shipment.barcode,e=t.orderNumber,r=t.shipmentNumber;this.$store.dispatch("csma/orderlist/"+_.TOGGLE_ORDER_POPUP,{componentName:"barcode",orderNumber:e,shipmentNumber:r})},onImageClick:function(t){this.showAdultPlaceholder&&(t.preventDefault(),t.stopPropagation(),this.setShowAdultModal(!0),this.$when.once("userInfo/SET_SHOW_ADULT",(function(){t.target.click()})))}})},W=(r("a51d8c"),Object(d.a)(O,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tracker-container with-shipments"},[r("div",{staticClass:"image-block",on:{click:t.onImageClick}},[r("CDNImageRetinaWrapper",{staticClass:"image",class:{"is-adult":t.shipment.isAdult&&!t.userShowAdult},attrs:{"is-adult":t.shipment.isAdult&&!t.userShowAdult,size:56,src:t.shipment.image}}),t._v(" "),t.shipment.productsCount>1?r("span",{staticClass:"qty"},[t._v(t._s(t.shipment.productsCount)),r("br"),t._v(t._s(t.getCountTitle))]):t._e()],1),t._v(" "),r("div",{staticClass:"information"},[r("h1",{staticClass:"title"},[t._v("\n      "+t._s(t.shipment.title)+"\n    ")]),t._v(" "),t.shipment.status?r("span",{staticClass:"status",style:{backgroundColor:t.shipment.status.color}},[t._v("\n      "+t._s(t.shipment.status.name.toUpperCase())+"\n    ")]):t._e(),t._v(" "),t.shipment.hint?r("span",{staticClass:"hint"},[t._v(t._s(t.shipment.hint))]):t._e(),t._v(" "),t.useBarcode&&t.shipment.barcode?r("a",{staticClass:"tracking-link",on:{click:t.onBarcodeClick}},[t._v("\n      "+t._s(t.shipment.barcode.title)+"\n    ")]):t._e(),t._v(" "),t.shipment.deliveryReviewInfo?[t.showReview?t._e():r("OzonButton",{staticClass:"review-btn",attrs:{color:"blue",size:"enlarged"},on:{click:t.onDeliveryReview}},[t._v("\n        Оценить доставку\n      ")]),t._v(" "),t.showReview?r("a",{staticClass:"tracking-link",on:{click:t.onDeliveryReview}},[t._v("\n        Мой отзыв о доставке\n      ")]):t._e()]:t._e()],2)])}),[],!1,null,"117c2185",null).exports),y={name:"OrderTrackingDesktop",components:{OrdersWithoutShipments:m,OrdersWithShipments:W,DropdownTooltip:r("574757").a},props:{widgetState:{type:Object,required:!0}},computed:{showSeparator:function(){return this.ordersWithoutShipments.length&&this.ordersWithShipments.length},ordersWithoutShipments:function(){var t=this.widgetState.ordersWithoutShipments;return t||[]},ordersWithShipments:function(){var t=this.widgetState.ordersWithShipments;return t||[]}}},k=(r("5eb472"),Object(d.a)(y,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("DropdownTooltip",[r("section",{staticClass:"order-tracking"},[r("div",{staticClass:"order-tracking-container"},[t.ordersWithoutShipments.length?r("div",{staticClass:"orders-without-shipments"},[t._l(t.ordersWithoutShipments,(function(e,n){return[r("div",{key:"order-"+n,staticClass:"content"},[r("a",{staticClass:"order-title",attrs:{href:"/my/orderlist/?order="+e.orderNumber}},[t._v("Заказ № "+t._s(e.orderNumber))]),t._v(" "),r("OrdersWithoutShipments",{attrs:{"order-without-shipments":e}})],1)]}))],2):t._e(),t._v(" "),t.showSeparator?r("div",{staticClass:"separator"}):t._e(),t._v(" "),t.ordersWithShipments.length?r("div",{staticClass:"orders-with-shipments"},[t._l(t.ordersWithShipments,(function(e,n){return[r("div",{key:"order-"+n,staticClass:"content"},[r("a",{staticClass:"order-title",attrs:{href:"/my/orderlist/?order="+e.orderNumber}},[t._v("Заказ № "+t._s(e.orderNumber))]),t._v(" "),t._l(e.shipments,(function(t,i){return[r("OrdersWithShipments",{key:"shipment-"+i,attrs:{shipment:t}})]}))],2)]}))],2):t._e()])])])}),[],!1,null,"d897401c",null).exports),A={name:"OrderTrackingMobile",components:{CsmaSlider:r("a17eb6").a,OrdersWithoutShipments:m,OrdersWithShipments:W},props:{widgetState:{type:Object,required:!0}},computed:{showSeparator:function(){return this.ordersWithoutShipments.length&&this.ordersWithShipments.length},ordersWithoutShipments:function(){var t=this.widgetState.ordersWithoutShipments;return t||[]},ordersWithShipments:function(){var t=this.widgetState.ordersWithShipments;return t||[]}},methods:{openOrderTrackingPopup:function(t){this.widgetState.useOrderTrackingPopup?this.$store.dispatch("csma/orderlist/OPEN_TRACKING_POPUP",{orderNumber:t}):this.$composerRouter.redirect("/my/orderlist/?order="+t)}}},E=(r("5753c7"),Object(d.a)(A,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"mobile-order-tracking"},[r("a",{staticClass:"mobile-tracking-title",attrs:{href:"/my/orderlist"}},[t._v("Ваши заказы")]),t._v(" "),r("div",{staticClass:"order-tracking-container"},[r("CsmaSlider",[r("template",{slot:"mainItems"},[t.ordersWithoutShipments.length?t._l(t.ordersWithoutShipments,(function(e,n){return r("div",{key:"order-"+n,staticClass:"content"},[r("div",{staticClass:"background",on:{click:function(r){return t.openOrderTrackingPopup(e.orderNumber)}}}),t._v(" "),r("h1",{staticClass:"order-title"},[t._v("\n              № "+t._s(e.orderNumber)+"\n            ")]),t._v(" "),r("OrdersWithoutShipments",{attrs:{"order-without-shipments":e,"use-barcode":t.widgetState.useBarcode}})],1)})):t._e(),t._v(" "),t.ordersWithShipments.length?t._l(t.ordersWithShipments,(function(e,n){return r("div",{key:"order-"+n,staticClass:"content"},[r("div",{staticClass:"background",on:{click:function(r){return t.openOrderTrackingPopup(e.orderNumber)}}}),t._v(" "),r("h1",{staticClass:"order-title"},[t._v("\n              № "+t._s(e.orderNumber)+"\n            ")]),t._v(" "),t._l(e.shipments,(function(e,i){return[r("OrdersWithShipments",{key:"shipment-"+i,attrs:{shipment:e,"use-barcode":t.widgetState.useBarcode}})]}))],2)})):t._e()],2)],2)],1)])}),[],!1,null,"0399ce7a",null).exports),I=function(){return(I=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},R=n.a.extend({name:"OrderTracking",components:{OrderTrackingDesktop:k,OrderTrackingMobile:E},computed:I({},Object(c.e)({isLoggedIn:function(t){var e=t.userInfo.user;return e&&e.isLoggedIn}}),{showWidget:function(){var t=this.widgetState,e=t.ordersWithoutShipments,r=t.ordersWithShipments;return!!e||!!r}}),created:function(){this.preventAsyncFetch()},mounted:function(){var t=this;this.isLoggedIn&&this.fetchAsyncState(),this.$when(["csma/orderlist/SET_CANCEL_ORDER","userInfo/SUCCESSFUL_ACCESS"],(function(){t.fetchAsyncState()}))},destroyed:function(){var t=this;this.$when.unsubscribe(["csma/orderlist/SET_CANCEL_ORDER","userInfo/SUCCESSFUL_ACCESS"],(function(){t.fetchAsyncState()}))}}),T=Object(d.a)(R,(function(){var t=this.$createElement,e=this._self._c||t;return this.showWidget&&this.isLoggedIn?e(this.isMobile?"OrderTrackingMobile":"OrderTrackingDesktop",{tag:"component",attrs:{"widget-state":this.widgetState}}):this._e()}),[],!1,null,null,null);e.default=T.exports},c4dc0f:function(t,e,r){"use strict";var n=r("757fb8");r.n(n).a},d108c6:function(t,e,r){},ffee13:function(t,e,r){}}]);